import json

from indexData.BaseData import BaseData


class MofComData(BaseData):
    def __init__(self, name):
        self.product_name_list = {
            '216': '丙烯（聚合）	国际市场现货价，CIF西北欧，聚合级',
            '217': '丙烯（化工）	国际市场现货价，CIF西北欧，化工级',
            '218': '丙烷	国际市场现货价，阿拉伯湾产，FOB沙特阿拉伯',
            '219': '聚氯乙烯（PVC）	国际市场现货价，FOB西北欧，悬浮级',
            '220': '低密度聚乙烯（LDPE）	国际市场现货价，FOB西北欧，通用级',
            '221': '线性低密度聚乙烯（LLDPE）	国际市场现货价，CFR俄罗斯圣彼得堡',
            '222': '高密度聚乙烯（HDPE注塑）	国际市场现货价，FOB西北欧，注塑级',
            '223': '高密度聚乙烯（HDPE吹塑）	国际市场现货价，FOB西北欧，吹塑级',
            '224': '高密度聚乙烯（HDPE薄膜）	国际市场现货价，FOB西北欧，薄膜级',
            '225': '聚苯乙烯（PS通用）	国际市场现货价，FOB西北欧，通用级',
            '226': '聚苯乙烯（PS高抗冲）	国际市场现货价，FOB西北欧，高抗冲级',
            '227': '聚丙烯（PP均聚）	国际市场现货价，FOB西北欧，均聚级',
            '228': '聚丙烯（PP共聚）	国际市场现货价，FOB西北欧，共聚级',
            '229': '树脂（ABS）	国际市场现货价，CFR东南亚，注塑级',
            '230': '乙烷	国际市场现货价，FOB鹿特丹，特级',
            '231': '异丙醇（IPA）	国际市场现货价，FOB鹿特丹',
            '232': '苯酚	国际市场现货价，FOB鹿特丹',
            '233': '丙酮	国际市场现货价，FOB鹿特丹，欧盟产须征税品',
            '236': '丁酮（N-BUT）	国际市场现货价，C&F东亚',
            '237': '辛醇（2-EH）	国际市场现货价，C&F东亚',
            '238': '醋酸（AA）	国际市场现货价，C&F东亚',
            '239': '醋酸（VAM）	国际市场现货价，C&F东亚',
            '240': '丙烯腈（ACN）	国际市场现货价，C&F东亚',
            '241': '氯乙烯（EDC）	国际市场现货价，C&F东亚',
            '242': '氯化物（VCM）	国际市场现货价，C&F东亚',
            '243': '丙烯	国际市场现货价，FOB韩国',
            '244': '丁二烯	国际市场现货价，FOB韩国',
            '245': '氨	CFR美国西部',
            '246': '氨	FOB波罗的海标准散装',
            # '247': '氨	FOB中东',
            # '248': '氨	FOB黑海',
            # '249': '尿素	FOB波罗的海',
            # '250': '尿素	FOB中东，散装颗粒',
            '251': '尿素	FOB中国，袋装',
            # '252': '尿素	CFR印度',
            # '253': '硫磺	FOB温哥华',
            # '254': '硫磺	FOB中东',
            # '255': '磷酸	CFR印度',
            # '256': '磷酸	CFR西北欧',
            '257': '氯化钾	CFR中国标准散装',
            # '258': '氯化钾	FOB温哥华标准散装',
            # '259': '氯化钾	FOB波罗的海标准散装',
            # '260': '氯化钾	CFR东南亚标准散装',
            # '261': '磷酸氢二铵	FOB约旦',
            # '265': '磷酸氢二铵	FOB黑海',
            '276': '乙醇	广州市场现货价',
            '379': '乙二醇	国际市场现货价，CIF鹿特丹，欧盟产非征税品',
            '281': '黄金（英）	伦敦市场现货收盘价',
            '283': '白银（英）	伦敦市场现货收盘价',
            '285': '铂（英）	伦敦市场现货收盘价',
            '287': '钯（英）	伦敦市场现货收盘价',
            '305': '硅铁	郑州商品交易所最近合约收盘价',
            '310': '黄金(香港)	香港市场现货价格',
            '311': '无氧铜丝	长江有色金属现货市场价',
            '312': '漆包线（0.1-3.1MM）	长江有色金属现货市场价',
            '313': '铜2#	长江有色金属现货市场价',
            '314': '铝A00	长江有色金属现货市场价',
            '315': '铅1#	长江有色金属现货市场价',
            '316': '锌0#	长江有色金属现货市场价',
            '317': '锌1#	长江有色金属现货市场价',
            '318': '镍板2#	长江有色金属现货市场价',
            '319': '锡2#	长江有色金属现货市场价',
            '320': '白银2#	长江有色金属现货市场价',
            '321': '钯	长江有色金属现货市场价',
            '322': '锡（吉）	马来西亚吉隆坡市场现货价',
            '323': '铜（A级）	伦敦金属交易所上午市现货结算价，A级',
            '324': '锡（英）	伦敦金属交易所上午市现货结算价',
            '325': '铅	伦敦金属交易所上午市现货结算价',
            '326': '锌	伦敦金属交易所上午市现货结算价',
            '327': '铝	伦敦金属交易所上午市现货结算价，A级',
            '328': '镍	伦敦金属交易所上午市现货结算价',
            # '329': '铝合金	伦敦金属交易所上午市现货结算价',
            # '330': '铜线材	伦敦市场现货价，电解铜，FOB英国工厂交货',
            # '331': '铜薄板	伦敦市场现货价，FOB英国工厂交货',
            # '333': '铜锌合金	伦敦市场现货价工厂交货，铜70%锌30%',
            # '335': '磷青铜	伦敦市场现货价，工厂交货，101级',
            '336': '锑	伦敦战略金属市场，鹿特丹仓库交货，99.65%',
            '337': '砷	伦敦战略金属市场，鹿特丹仓库交货，99.0%',
            '338': '铋	伦敦战略金属市场，鹿特丹仓库交货，99.99%',
            '339': '镉（0.95）	伦敦战略金属市场，鹿特丹仓库交货，99.95%',
            '340': '镉（0.99）	伦敦战略金属市场，鹿特丹仓库交货，99.99%',
            '341': '铬铝合金	伦敦战略金属市场，鹿特丹仓库交货，99.8%中国产',
            '342': '铬铁	伦敦战略金属市场，鹿特丹仓库交货，俄罗斯产',
            '343': '钴	伦敦战略金属市场，鹿特丹仓库交货，99.8%',
            '344': '钴锭	伦敦战略金属市场，鹿特丹仓库交货，99.3%',
            '345': '镓锭	伦敦战略金属市场，鹿特丹仓库交货，99.99%',
            '346': '金属锗	伦敦战略金属市场，鹿特丹仓库交货，50欧姆',
            '347': '氧化锗	伦敦战略金属市场，鹿特丹仓库交货，99.99%',
            '348': '铟锭	伦敦战略金属市场，鹿特丹仓库交货，99.99%',
            '349': '铱	伦敦战略金属市场，鹿特丹仓库交货，99.9%',
            '350': '镁	伦敦战略金属市场，鹿特丹仓库交货，99.9%',
            '352': '金属锰	伦敦战略金属市场，鹿特丹仓库交货，99.7%',
            '353': '锰铁	伦敦战略金属市场，鹿特丹仓库交货，75-76%',
            '354': '氧化钼	伦敦战略金属市场，欧洲仓库交货，57%(Mo03)',
            '355': '钼铁	伦敦战略金属市场，欧洲仓库交货，65%',
            '356': '铑	伦敦战略金属市场，鹿特丹仓库交货，99.99%',
            '357': '钌	伦敦战略金属市场，鹿特丹仓库交货，99.99%',
            '358': '硒	伦敦战略金属市场，鹿特丹仓库交货，99.5%',
            '359': '硅	伦敦战略金属市场，鹿特丹仓库交货，98.5%',
            '360': '硅铁	伦敦战略金属市场，鹿特丹仓库交货，75%',
            '361': '钽铁矿	伦敦战略金属市场，CIF北欧，30-35%',
            '362': '海绵钛	伦敦战略金属市场，鹿特丹仓库交货，99.6%',
            '363': '钛铁	伦敦战略金属市场，鹿特丹仓库交货，68%',
            '364': '仲钨酸铵（APT）	伦敦战略金属市场，鹿特丹仓库交货，中国产',
            '365': '钨铁	伦敦战略金属市场，鹿特丹仓库交货，80-85%',
            '366': '钒铁	伦敦战略金属市场，鹿特丹仓库交货，80%',
            '367': '氧化钒	伦敦战略金属市场，鹿特丹仓库交货，98%',
            '368': '铜（美）	纽约商品交易所最近期货收盘价，高级',
            '374': '氧化铝	长江有色金属中国进口均价',
            '375': '废钢材	CIF中国港口到岸价（来源美国）',
            # '4': '大米（10%）	泰国市场，含碎10%，FOB曼古',
            # '5': '大米（25%）	泰国市场，含碎25%，FOB曼古',
            # '6': '大米（5%）	泰国市场，含碎5%，FOB曼古',
            '13': '豆粕（巴西）	巴西现货，蛋白含量48%',
            '14': '玉米	美国市场2号黄玉米现货价',
            '15': '小麦（美）	美国农业部报价，2号软红冬',
            '16': '豆油	阿根廷市场现货价格',
            '20': '高梁	阿根廷出口FOB价',
            '21': '葵花籽	阿根廷出口FOB价',
            '22': '花生仁	阿根廷出口FOB价食用',
            '23': '大豆（阿）	阿根廷出口FOB价',
            '24': '椰干	欧洲市场，菲律宾/印尼产，CIF鹿特丹',
            '25': '豆油	欧洲市场，荷兰产脱胶，FOB工厂交货',
            '26': '菜籽油	欧洲市场，荷兰/欧盟产，FOB工厂/油罐交货',
            '27': '葵花籽油	欧洲市场，欧盟产，FOB欧洲五港口油罐交货',
            '28': '花生油	意大利CIF到岸价',
            '29': '亚麻油	欧洲市场，不分产地，CIF鹿特丹油罐交货',
            '30': '棕榈油	马来西亚/苏门答腊粗制，CIF英/鹿特丹',
            '31': '椰油	欧洲市场，菲律宾/印尼产，CIF鹿特丹',
            '32': '棕仁油	欧洲市场，马来西亚/印尼产，CIF鹿特丹',
            '34': '蓖麻油	欧洲市场，巴西一级，CIF鹿特丹油罐交货',
            '35': '棕榈脂肪酸	欧洲市场，FOB马来西亚港口交货',
            '36': '花生油（美）	美国市场现货FOB价，粗制',
            '37': '豆油（美）	美国市场现货价，粗制，FOB伊利诺斯',
            '38': '棉籽油（美）	美国市场现货价，粗制，FOB密西西比谷',
            '39': '玉米油（美）	美国市场现货价，粗制散装，FOB纽约',
            # '40': '亚麻油（美）	美国市场现货FOB价，粗制',
            # '41': '蓖麻油（美）	美国市场现货FOB价，巴西一级粗制',
            # '42': '椰油（美）	美国市场现货CIF价，菲律宾产粗制',
            # '43': '棕榈油（美）	美国市场现货CIF价，粗制',
            # '44': '棕仁油（美）	现货价，马来西亚/印尼产粗制，CIF纽约',
            # '45': '猪油	美国芝加哥现货C&F价，真空工艺生产，可食用',
            # '46': '牛羊脂（食）	美国芝加哥现货C&F价，可食用',
            # '47': '牛羊脂（非）	美国芝加哥现货C&F价，非食用脱色',
            # '48': '白炼脂	美国芝加哥现货FOB价，优质非食用',
            # '49': '黄色油脂	美国芝加哥现货FOB价',
            # '50': '橄榄油	现货价，CIF意大利',
            # '51': '鱼粉	现货价，智利产含蛋白脂65%，C&F不来梅/汉堡垒',
            # '53': '苜蓿粉	美国市场批发价脱水饲料FOB堪萨斯城卡车交货',
            # '60': '原糖	国际糖理事会每日糖价，FOB加勒比海船仓交货',
            # '63': '白糖（5号）	伦国际金融期货交易所最近期货收盘价，5号合同',
            # '67': '棉籽饼	美国出口价，散装，FOB堪萨斯',
            # '69': '豆粉	美国堪萨斯市场现货价，含量48%',
            # '70': '茶叶（特级）	肯尼亚市场，内罗毕拍卖价，特级',
            # '71': '茶叶（高级）	肯尼亚市场，内罗毕拍卖价，高级',
            # '72': '茶叶（高中）	肯尼亚市场，内罗毕拍卖价，高/中级',
            # '73': '茶叶（中级）	肯尼亚市场，内罗毕拍卖价，中级',
            # '74': '茶叶（低级）	肯尼亚市场，内罗毕拍卖价，低级',
            # '75': '茶叶	肯尼亚2级均质叶茶',
            # '76': '茶叶	乌干达2级均质叶茶',
            # '77': '茶叶	卢旺达2级均质叶茶',
            # '78': '茶叶	布隆迪2级均质叶茶',
            # '79': '茶叶	扎伊尔2级均质叶茶',
            # '80': '茶叶	马拉维2级均质叶茶',
            # '81': '茶叶	坦桑尼亚2级均质叶茶',
            # '82': '茶叶	莫桑比克2级均质叶茶',
            # '83': '茶叶	马达加斯加2级均质叶茶',
            '90': '棉花（德）	德国不莱梅仓库交货，美国东部产优质中级1.3/32英寸',
            '91': '棉花（综合指数）	英国利物浦《棉花展望》综合指数',
            '142': '棕榈油(天津现)	天津港现货价格',
            '143': '豆粕（江苏现）	江苏南通现货批发价',
            '144': '小麦(黄埔批)	国内市场优质小麦批发价格',
            '145': '大豆(哈尔滨批)	哈尔滨市场批发价',
            '146': '玉米（郑州现）	郑州市场现货价',
            '147': '黄玉米（大连现）	大连市场现货价',
            '149': '大豆粉	哈尔滨市场现货价',
            '150': '玉米油	中国中部工厂粗制',
            '151': '早籼稻	长沙市场现货价',
            '152': '玉米粉	长春市场现货价',
            '153': '普通小麦	郑州现货价',
            '154': '大豆	青岛到岸价',
            '155': '豆油（标准）	佳木斯出厂价',
            '156': '菜籽粕	合肥市场现货价',
            '157': '菜籽油	成都市场现货价',
            '158': '精炼棕榈油	连云港市场现货价',
            '159': '葵花籽油（出厂价）	中国北方市场现货价',
            '160': '鱼粉（标准含运费）	大连进口价',
            '161': '花生	中国东部市场现货价',
            '162': '花生粕	山东出厂价',
            '163': '花生油	山东出厂价',
            '164': '棉籽粕	新疆出厂价',
            '165': '棉花	现货价，中国新疆产',
            '166': '棉籽	河北工厂价',
            '167': '棉籽油	河北出厂价',
            '169': '棕榈油精炼（24度）	广东黄埔现货价',
            '170': '猪肉	广东市场现货价',
            '171': '仔猪	四川（成都）市场现货价',
            '172': '仔鸡	马鞍山市场现货价',
            '173': '鸡蛋	衡水市场现货价',
            '351': '大葱	山东章丘现货价',
            '381': '香菇	福建闽福鼎市场现货价',
            '282': '黄金（美）	纽约商品交易所最近期货收盘价',
            '284': '白银（美）	纽约商品交易所最近期收盘价',
            '286': '铂（美）	纽约商品交易所最近期货收盘价',
            '288': '钯（美）	纽约商品交易所最近期货收盘价',
            '289': '铝	上海期货交易所最近合约收盘价',
            '290': '铜	上海期货交易所最近合约收盘价',
            '291': '黄金99.95	上海黄金交易所收盘价',
            '292': '黄金99.99	上海黄金交易所收盘价',
            '293': '铂99.95	上海黄金交易所收盘价',
            '294': '白银99.99	上海黄金交易所收盘价',
            '295': '白银99.9	上海黄金交易所收盘价',
            '296': '镍	上海期货交易所最近合约收盘价',
            '297': '锌	上海期货交易所最近合约收盘价',
            '299': '螺纹钢	上海期货交易所最近合约收盘价',
            '300': '铅	上海期货交易所最近合约收盘价',
            '301': '线材	上海期货交易所最近合约收盘价',
            '303': '锡	上海期货交易所最近合约收盘价',
            '304': '热轧卷板	上海期货交易所最近合约收盘价',
            '306': '硅锰	郑州商品交易所最近合约收盘价',
            '307': '铁矿石	大连商品交易所最近合约收盘价',
            '272': '聚氯乙烯	大连商品交易所最近合约收盘价',
            '273': '精对苯二甲酸	郑州商品交易所最近合约收盘价',
            '274': '甲醇	郑州商品交易所最近合约收盘价',
            '275': '动力煤	郑州商品交易所最近合约收盘价',
            '376': '纤维板	大连商品交易所最近合约收盘价',
            '377': '胶合板	大连商品交易所最近合约收盘价',
            '378': '原油（中）	上海国际能源交易中心最近合约收盘价（中质含硫）',
            '380': '原油（布期）	洲际交易所(ICE)布伦特原油最近期货收盘价',
            '1': '红小豆	日本东京谷物交易所最近期货收盘价',
            '2': '大豆（日）	日本东京谷物交易所最近期货收盘价',
            '3': '玉米（日）	日本东京谷地交易所蕞近期货收盘价',
            '7': '小麦（CBT）	芝加哥商品交易所最近期货收盘价，60磅/蒲式耳',
            '8': '玉米（CBT）	芝加哥商品交易所最近期货收盘价，56磅/蒲式耳',
            '9': '燕麦（CBT）	芝加哥商品交易所最近期货收盘价，32磅/蒲式耳',
            '10': '大豆（CBT）	芝加哥商品交易所最近期货收盘价，60磅/蒲式耳',
            '11': '豆油（CBT）	芝加哥商品交易所最近期货收盘价',
            '12': '豆粕（CBT）	芝加哥商品交易所最近期货收盘价',
            '17': '黄油	芝加哥商品交易所最近期货收盘价',
            '18': '菜籽	加拿大温尼伯交易所最近期货收盘价',
            '19': '稻谷	美国芝加哥期货交易所最近期货收盘价',
            '54': '木材	芝加哥商业交易所最近期货收盘价',
            '56': '活猪	芝加哥商业交易所最近期货收盘价',
            '57': '菜牛	芝加哥商业交易所最近期货收盘价',
            '58': '活牛	芝加哥商业交易所最近期货收盘价',
            '59': '糖（11号）	纽约咖啡糖可可交易所最近期货收盘价',
            # '64': '牛奶（四号）	美国芝加哥商业交易所',
            # '84': '可可（英）	伦敦商品交易所最近期货收盘价',
            # '85': '可可（美）	纽约可可、糖、咖啡交易所期货收盘价',
            # '86': '咖啡（英）	伦敦商品交易所最近期货收盘价，中粒',
            # '87': '咖啡（美）	纽约可可、糖、咖啡交易所期货收盘价',
            # '88': '冻桔汁	纽约商品交易所最近期货收盘价',
            '89': '棉花（美）	纽约棉花交易所最近期货收盘价，2号合同白',
            '127': '大豆1号	大连商品交易所最近合约收盘价',
            '128': '大豆2号	大连商品交易所最近合约收盘价',
            '129': '棕榈油(大连期结算)	大连商品交易所最近合约收盘价',
            '130': '豆油（大连期结）	大连商品交易所最近合约收盘价',
            '131': '玉米（大连期结）	大连商品交易所最近合约收盘价',
            '132': '豆粕(大连)	大连商品交易所最近合约收盘价',
            '133': '鸡蛋	大连商品交易所最近合约收盘价',
            '134': '普通小麦	郑州商品交易所最近合约收盘价',
            '135': '强筋小麦	郑州商品交易所最近合约收盘价',
            '136': '棉花1号	郑州商品交易所最近合约收盘价',
            '137': '白糖	郑州商品交易所最近合约收盘价',
            '138': '菜籽油	郑州商品交易所最近合约收盘价',
            '139': '早籼稻	郑州商品交易所最近合约收盘价',
            '140': '油菜籽	郑州商品交易所最近合约收盘价',
            '141': '菜籽粕	郑州商品交易所最近合约收盘价'
        }
        BaseData.__init__(self, name)

    def get_product_name(self, product_id):
        return self.product_name_list[product_id]

    def get_all_product(self):
        return self.product_name_list

    def get_data(self, product_id):
        data_url = 'http://price.mofcom.gov.cn/datamofcom/front/price/pricequotation/priceQueryList?seqno=' + product_id + '&startTime=&endTime=&pageNumber=1&pageSize=500'
        res_data = self.post_url_data(data_url, {})
        json_date = json.loads(res_data)
        # print(json_date)
        price_data = json_date["rows"]
        return_data = []
        print(price_data[0]['prod_name'])
        for one in price_data:
            if one['price'] is None or one['price'] == '-':
                return None
            return_data.append(float(one['price']))

        self.return_data = {
            "name": self.product_name_list[product_id],
            "week": 7,
            "data": return_data
        }
        return self.return_data
